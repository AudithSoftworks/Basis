language: php

php:
  - 5.4
  - 5.5
  - 5.6
  - hhvm

env:
  - DB=mysql
  - DB=pgsql

addons:
  postgresql: "9.3"

matrix:
  exclude:
    - php: "hhvm"
      env: DB=pgsql

sudo: false

before_script:
  - if [[ "$DB" == "mysql" ]]; then mysql -e "CREATE DATABASE IF NOT EXISTS basis;" -uroot; fi
  - if [[ "$DB" == "pgsql" ]]; then psql -c "CREATE DATABASE basis;" -U postgres; fi

install: travis_retry composer install --no-interaction --prefer-source

script:
  - php artisan migrate --force
  - vendor/bin/phpunit
